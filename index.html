<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prezenta Scoala de Squash in Oras 2025 </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #dbeafe 0%, #dcfce7 100%);
            min-height: 100vh;
            padding: 1rem;
        }
        
        .app {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(90deg, #2563eb, #16a34a);
            color: white;
            padding: 1.5rem;
        }
        
        .header h1 {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }
        
        .date-input {
            width: 100%;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            font-size: 0.875rem;
        }
        
        .stats {
            padding: 1rem;
            background: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .stats-text {
            font-weight: 600;
            color: #374151;
        }
        
        .backup-btn, .export-btn {
            background: none;
            border: none;
            color: #2563eb;
            padding: 0.5rem;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 0.5rem;
        }
        
        .backup-btn:hover, .export-btn:hover {
            background: #eff6ff;
        }
        
        .player-list {
            padding: 1rem;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .player {
            background: #f9fafb;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .player-avatar {
            width: 48px;
            height: 48px;
            background: #e5e7eb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #9ca3af;
            flex-shrink: 0;
            overflow: hidden;
        }
        
        .player-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .player-info {
            flex: 1;
            min-width: 0;
        }
        
        .player-name {
            font-weight: 600;
            color: #1f2937;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .player-level {
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .player-contact {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-top: 0.25rem;
        }
        
        .edit-buttons {
            display: flex;
            gap: 0.25rem;
            margin-left: 0.5rem;
        }
        
        .edit-btn, .delete-btn {
            background: none;
            border: none;
            padding: 0.25rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.875rem;
        }
        
        .edit-btn {
            color: #2563eb;
        }
        
        .edit-btn:hover {
            background: #eff6ff;
        }
        
        .delete-btn {
            color: #dc2626;
        }
        
        .delete-btn:hover {
            background: #fef2f2;
        }
        
        .edit-form {
            display: none;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            margin-top: 0.75rem;
        }
        
        .edit-form.active {
            display: block;
        }
        
        .photo-upload {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 0.75rem;
        }
        
        .photo-preview {
            width: 64px;
            height: 64px;
            background: #e5e7eb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #9ca3af;
            overflow: hidden;
        }
        
        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .photo-upload-btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
        }
        
        .photo-upload-btn:hover {
            background: #1d4ed8;
        }
        
        .attendance-btn {
            width: 48px;
            height: 48px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.2s;
        }
        
        .present {
            background: #dcfce7;
            color: #16a34a;
        }
        
        .absent {
            background: #fecaca;
            color: #dc2626;
        }
        
        .add-section {
            padding: 1rem;
            border-top: 1px solid #e5e7eb;
        }
        
        .add-player-btn {
            width: 100%;
            background: #2563eb;
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            font-size: 1rem;
        }
        
        .add-player-btn:hover {
            background: #1d4ed8;
        }
        
        .add-form {
            display: none;
        }
        
        .add-form.active {
            display: block;
        }
        
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            margin-bottom: 0.75rem;
            font-size: 1rem;
        }
        
        .form-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn-primary {
            flex: 1;
            background: #2563eb;
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .btn-secondary {
            flex: 1;
            background: #9ca3af;
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .backup-panel {
            display: none;
            padding: 1rem;
            background: #eff6ff;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .backup-panel.active {
            display: block;
        }
        
        .backup-title {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        
        .backup-instructions {
            background: white;
            padding: 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 1rem;
        }
        
        .backup-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        .status-message {
            background: white;
            padding: 0.75rem;
            border-radius: 6px;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- Header -->
        <div class="header">
            <h1>üìÖ Squash Camp Attendance</h1>
            <input type="date" class="date-input" id="currentDate">
        </div>
        
        <!-- Stats -->
        <div class="stats">
            <div class="stats-text" id="statsText">0/0 Present (0%)</div>
            <div>
                <button class="backup-btn" onclick="toggleBackup()" title="Backup">‚òÅÔ∏è</button>
                <button class="export-btn" onclick="exportData()" title="Export">üíæ</button>
            </div>
        </div>
        
        <!-- Backup Panel -->
        <div class="backup-panel" id="backupPanel">
            <div class="backup-title">‚òÅÔ∏è Backup & Sync</div>
            <div class="status-message hidden" id="statusMessage"></div>
            <button class="btn-primary" onclick="copyBackupData()" style="width: 100%; margin-bottom: 0.75rem;">
                Copy Data for GitHub
            </button>
            <div class="backup-instructions">
                <strong>To backup to GitHub:</strong><br>
                1. Tap "Copy Data"<br>
                2. Go to your GitHub repo<br>
                3. Create new file: backup-<span id="todayDate"></span>.json<br>
                4. Paste and commit
            </div>
            <div class="backup-buttons">
                <label class="btn-primary" style="text-align: center; cursor: pointer;">
                    Import Backup
                    <input type="file" accept=".json" onchange="importData(event)" class="hidden">
                </label>
                <button class="btn-secondary" onclick="exportData()">Download</button>
            </div>
        </div>
        
        <!-- Player List -->
        <div class="player-list" id="playerList">
            <!-- Players will be added here by JavaScript -->
        </div>
        
        <!-- Add Player Section -->
        <div class="add-section">
            <button class="add-player-btn" id="addPlayerBtn" onclick="showAddForm()">
                ‚ûï Add New Player
            </button>
            <div class="add-form" id="addForm">
                <div class="photo-upload">
                    <div class="photo-preview" id="newPlayerPhotoPreview">üì∑</div>
                    <div>
                        <label class="photo-upload-btn" for="newPlayerPhoto">Add Photo</label>
                        <input type="file" accept="image/*" id="newPlayerPhoto" class="hidden" onchange="handlePhotoUpload(event, 'new')">
                    </div>
                </div>
                <input type="text" class="form-input" id="newPlayerName" placeholder="Player Name">
                <select class="form-input" id="newPlayerLevel">
                    <option value="Beginner">Beginner</option>
                    <option value="Intermediate">Intermediate</option>
                    <option value="Advanced">Advanced</option>
                </select>
                <input type="tel" class="form-input" id="newPlayerPhone" placeholder="Phone Number">
                <input type="email" class="form-input" id="newPlayerEmail" placeholder="Email Address">
                <div class="form-buttons">
                    <button class="btn-primary" onclick="addPlayer()">Add Player</button>
                    <button class="btn-secondary" onclick="hideAddForm()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let players = [];
        let attendance = {};
        let currentDate = new Date().toISOString().split('T')[0];
        let editingPlayerId = null;
        let newPlayerPhoto = '';
        
        // Initialize app
        function init() {
            // Load data from localStorage
            loadData();
            
            // Set current date
            document.getElementById('currentDate').value = currentDate;
            document.getElementById('todayDate').textContent = currentDate;
            
            // Bind date change event
            document.getElementById('currentDate').addEventListener('change', function(e) {
                currentDate = e.target.value;
                updateStats();
            });
            
            // Render initial state
            renderPlayers();
            updateStats();
        }
        
        // Load data from localStorage
        function loadData() {
            try {
                const savedPlayers = localStorage.getItem('squash-players');
                players = savedPlayers ? JSON.parse(savedPlayers) : [
                    { id: 1, name: 'Alex Johnson', level: 'Beginner', phone: '', email: '', photo: '' },
                    { id: 2, name: 'Maria Silva', level: 'Intermediate', phone: '', email: '', photo: '' },
                    { id: 3, name: 'Tom Wilson', level: 'Advanced', phone: '', email: '', photo: '' },
                    { id: 4, name: 'Sarah Chen', level: 'Beginner', phone: '', email: '', photo: '' },
                    { id: 5, name: 'David Brown', level: 'Intermediate', phone: '', email: '', photo: '' }
                ];
                
                const savedAttendance = localStorage.getItem('squash-attendance');
                attendance = savedAttendance ? JSON.parse(savedAttendance) : {};
            } catch (e) {
                console.warn('Could not load data from localStorage');
            }
        }
        
        // Save data to localStorage
        function saveData() {
            try {
                localStorage.setItem('squash-players', JSON.stringify(players));
                localStorage.setItem('squash-attendance', JSON.stringify(attendance));
            } catch (e) {
                console.warn('Could not save data to localStorage');
            }
        }
        
        // Render players
        function renderPlayers() {
            const playerList = document.getElementById('playerList');
            playerList.innerHTML = '';
            
            players.forEach(player => {
                const isPresent = attendance[currentDate]?.[player.id] || false;
                
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player';
                
                // Create player HTML
                const playerHTML = `
                    <div class="player-avatar">
                        ${player.photo ? `<img src="${player.photo}" alt="${player.name}">` : 'üë§'}
                    </div>
                    <div class="player-info">
                        <div class="player-name">${player.name}</div>
                        <div class="player-level">${player.level}</div>
                        ${player.phone ? `<div class="player-contact">üìû ${player.phone}</div>` : ''}
                        ${player.email ? `<div class="player-contact">üìß ${player.email}</div>` : ''}
                    </div>
                    <div class="edit-buttons">
                        <button class="edit-btn" onclick="showEditForm(${player.id})" title="Edit">‚úèÔ∏è</button>
                        <button class="delete-btn" onclick="deletePlayer(${player.id})" title="Delete">üóëÔ∏è</button>
                    </div>
                    <button class="attendance-btn ${isPresent ? 'present' : 'absent'}" 
                            onclick="toggleAttendance(${player.id})">
                        ${isPresent ? '‚úì' : '‚úó'}
                    </button>
                `;
                
                playerDiv.innerHTML = playerHTML;
                
                // Add edit form
                const editForm = document.createElement('div');
                editForm.className = 'edit-form';
                editForm.id = `edit-form-${player.id}`;
                editForm.innerHTML = `
                    <div class="photo-upload">
                        <div class="photo-preview" id="edit-photo-preview-${player.id}">
                            ${player.photo ? `<img src="${player.photo}" alt="${player.name}">` : 'üì∑'}
                        </div>
                        <div>
                            <label class="photo-upload-btn" for="edit-photo-${player.id}">Change Photo</label>
                            <input type="file" accept="image/*" id="edit-photo-${player.id}" class="hidden" onchange="handlePhotoUpload(event, 'edit', ${player.id})">
                        </div>
                    </div>
                    <input type="text" class="form-input" id="edit-name-${player.id}" value="${player.name}" placeholder="Player Name">
                    <select class="form-input" id="edit-level-${player.id}">
                        <option value="Beginner" ${player.level === 'Beginner' ? 'selected' : ''}>Beginner</option>
                        <option value="Intermediate" ${player.level === 'Intermediate' ? 'selected' : ''}>Intermediate</option>
                        <option value="Advanced" ${player.level === 'Advanced' ? 'selected' : ''}>Advanced</option>
                    </select>
                    <input type="tel" class="form-input" id="edit-phone-${player.id}" value="${player.phone}" placeholder="Phone Number">
                    <input type="email" class="form-input" id="edit-email-${player.id}" value="${player.email}" placeholder="Email Address">
                    <div class="form-buttons">
                        <button class="btn-primary" onclick="savePlayer(${player.id})">Save</button>
                        <button class="btn-secondary" onclick="hideEditForm(${player.id})">Cancel</button>
                    </div>
                `;
                
                playerDiv.appendChild(editForm);
                playerList.appendChild(playerDiv);
            });
        }
        
        // Toggle attendance
        function toggleAttendance(playerId) {
            if (!attendance[currentDate]) {
                attendance[currentDate] = {};
            }
            attendance[currentDate][playerId] = !attendance[currentDate][playerId];
            saveData();
            renderPlayers();
            updateStats();
        }
        
        // Update stats
        function updateStats() {
            const todayAttendance = attendance[currentDate] || {};
            const present = Object.values(todayAttendance).filter(Boolean).length;
            const total = players.length;
            const percentage = total > 0 ? Math.round((present / total) * 100) : 0;
            
            document.getElementById('statsText').textContent = `${present}/${total} Present (${percentage}%)`;
        }
        
        // Show add form
        function showAddForm() {
            document.getElementById('addPlayerBtn').style.display = 'none';
            document.getElementById('addForm').classList.add('active');
        }
        
        // Hide add form
        function hideAddForm() {
            document.getElementById('addPlayerBtn').style.display = 'block';
            document.getElementById('addForm').classList.remove('active');
            
            // Clear form
            document.getElementById('newPlayerName').value = '';
            document.getElementById('newPlayerLevel').value = 'Beginner';
            document.getElementById('newPlayerPhone').value = '';
            document.getElementById('newPlayerEmail').value = '';
            document.getElementById('newPlayerPhotoPreview').innerHTML = 'üì∑';
            newPlayerPhoto = '';
        }
        
        // Add player
        function addPlayer() {
            const name = document.getElementById('newPlayerName').value.trim();
            const level = document.getElementById('newPlayerLevel').value;
            const phone = document.getElementById('newPlayerPhone').value.trim();
            const email = document.getElementById('newPlayerEmail').value.trim();
            
            if (!name) return;
            
            const newPlayer = {
                id: Date.now(),
                name: name,
                level: level,
                phone: phone,
                email: email,
                photo: newPlayerPhoto
            };
            
            players.push(newPlayer);
            saveData();
            renderPlayers();
            updateStats();
            hideAddForm();
        }
        
        // Show edit form
        function showEditForm(playerId) {
            // Hide any other open edit forms
            document.querySelectorAll('.edit-form').forEach(form => {
                form.classList.remove('active');
            });
            
            // Show this edit form
            document.getElementById(`edit-form-${playerId}`).classList.add('active');
            editingPlayerId = playerId;
        }
        
        // Hide edit form
        function hideEditForm(playerId) {
            document.getElementById(`edit-form-${playerId}`).classList.remove('active');
            editingPlayerId = null;
        }
        
        // Save player changes
        function savePlayer(playerId) {
            const name = document.getElementById(`edit-name-${playerId}`).value.trim();
            const level = document.getElementById(`edit-level-${playerId}`).value;
            const phone = document.getElementById(`edit-phone-${playerId}`).value.trim();
            const email = document.getElementById(`edit-email-${playerId}`).value.trim();
            
            if (!name) return;
            
            // Get the current photo from the preview
            const photoPreview = document.getElementById(`edit-photo-preview-${playerId}`);
            const photoImg = photoPreview.querySelector('img');
            const photo = photoImg ? photoImg.src : '';
            
            // Update player
            const playerIndex = players.findIndex(p => p.id === playerId);
            if (playerIndex !== -1) {
                players[playerIndex] = {
                    ...players[playerIndex],
                    name: name,
                    level: level,
                    phone: phone,
                    email: email,
                    photo: photo
                };
            }
            
            saveData();
            renderPlayers();
            updateStats();
        }
        
        // Delete player
        function deletePlayer(playerId) {
            if (!confirm('Are you sure you want to delete this player?')) return;
            
            // Remove player
            players = players.filter(p => p.id !== playerId);
            
            // Remove from attendance records
            Object.keys(attendance).forEach(date => {
                delete attendance[date][playerId];
            });
            
            saveData();
            renderPlayers();
            updateStats();
        }
        
        // Handle photo upload
        function handlePhotoUpload(event, type, playerId = null) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const photoData = e.target.result;
                
                if (type === 'new') {
                    newPlayerPhoto = photoData;
                    document.getElementById('newPlayerPhotoPreview').innerHTML = `<img src="${photoData}" alt="Preview">`;
                } else if (type === 'edit' && playerId) {
                    document.getElementById(`edit-photo-preview-${playerId}`).innerHTML = `<img src="${photoData}" alt="Preview">`;
                }
            };
            reader.readAsDataURL(file);
        }
        
        // Toggle backup panel
        function toggleBackup() {
            const panel = document.getElementById('backupPanel');
            panel.classList.toggle('active');
        }
        
        // Copy backup data
        function copyBackupData() {
            const data = {
                players: players,
                attendance: attendance,
                exportDate: new Date().toISOString(),
                version: '1.0'
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(dataStr).then(() => {
                    showStatus('‚úÖ Data copied to clipboard!');
                }).catch(() => {
                    fallbackCopy(dataStr);
                });
            } else {
                fallbackCopy(dataStr);
            }
        }
        
        // Fallback copy method
        function fallbackCopy(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                showStatus('‚úÖ Data copied to clipboard!');
            } catch (err) {
                showStatus('‚ùå Please use Export button instead');
            }
            
            document.body.removeChild(textArea);
        }
        
        // Export data
        function exportData() {
            const data = {
                players: players,
                attendance: attendance,
                exportDate: new Date().toISOString(),
                version: '1.0'
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `squash-attendance-backup-${currentDate}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }
        
        // Import data
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.players && data.attendance) {
                        players = data.players;
                        attendance = data.attendance;
                        saveData();
                        renderPlayers();
                        updateStats();
                        showStatus('‚úÖ Data imported successfully!');
                    } else {
                        showStatus('‚ùå Invalid backup file format');
                    }
                } catch (error) {
                    showStatus('‚ùå Error reading backup file');
                }
            };
            reader.readAsText(file);
        }
        
        // Show status message
        function showStatus(message) {
            const statusEl = document.getElementById('statusMessage');
            statusEl.textContent = message;
            statusEl.classList.remove('hidden');
            setTimeout(() => {
                statusEl.classList.add('hidden');
            }, 3000);
        }
        
        // Initialize app when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>
